# 网络web知识

<https://juejin.im/post/598ba1d06fb9a03c4d6464ab>

本文档性能文档，也有对tcp/http的介绍 [性能文档](../performance.md#TCP)

- [TCP/IP](#TCP/IP)
- [知识点](#知识点)

***

## TCP/IP

通常使用的网络是在TCP/IP协议族的基础上运作的，而HTTP属于它内部的一个子集。

TCP/IP是互联网相关的各类协议族的总称:IP,PPPoE,DNS,UDP,FTP,SNMP,HTTP,FDDI,ICMP,IEEE 802.3,

利用TCP/IP协议族进行网络通信时，会通过分层顺序与对方进行通信。发送端从应用层往下走，接收端从链路层往上走。

IP协议的作用是把各种数据包传送给对方。

ARP是一种用以解析地址的协议，根据通信方的IP地址就可以反查对应的MAC地址。

### TCP/IP协议族按层次分别分为以下4层

应用层：应用层决定了向用户提供应用服务时通信的活动。TCP/IP协议族内预存了各类通用的应用服务。比如：[FTP DNS HTTP SMTP POP3 SSH]

传输层：传输层对上层应用层，提供处于网络链接中的两台计算机之间的数据传输。有两个性质不同的协议 [TCP UDP]

网络层：网络层用来处理网络上流动的数据包，数据包是网络传输的最小数据单位。该层规定了通过怎样的路径到达对方计算机，并把数据包传送给对方。[IP ICMP ARP RARP]

数据链路层: 用来处理链接网络的硬件部分。包括控制操作系统，硬件的设备驱动，NIC，及光纤等物理可见部分。硬件上的范畴均在链路层的作用范围之内。

### TCP三次握手

确保数据能到达目标，TCP协议采用了三次握手策略 :

syn ：（序号），SYNchronize

ack ：（确认号），acknowledgement number

1. 第一次握手：客户端发送syn包(syn=j)到服务器，并进入SYN_SEND状态，等待服务器确认；

2. 第二次握手：服务器收到syn包，必须确认客户的SYN（ack=j+1），同时自己也发送一个SYN包（syn=k），即SYN+ACK包，此时服务器进入SYN_RECV状态；

3. 第三次握手：客户端收到服务器的SYN＋ACK包，向服务器发送确认包ACK(ack=k+1)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。

握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP 连接都将被一直保持下去。断开连接时服务器和客户端均可以主动发起断开TCP连接的请求，断开过程需要经过“四次握手”（过程就不细写了，就是服务器和客户端交互，最终确定断开）

### 为什么要三次握手

防止已失效的连接请求又传送到服务器端，因而产生错误

防止其中一方停止发送后，另一方持续等待。

## DNS

- DNS（Domain Name System）

DNS服务是和HTTP协议一样位于应用层的协议，它提供域名到IP地址之间的解析服务。

## URL URI

URL是URI的子集

## POST和GET

### 区别

注意：以下描述有问题，应该是url传参和data传参区别，并不是get和post

```
大小方面: GET传输一般2M，POST没有大小限制

安全方面: GET通过url明文传输，POST通过body传输，本身都不安全，因为HTTP就是明文传输。

浏览器记录: GET请求浏览器会记录，POST不会

浏览器后退: GET无害，POST会再次提交

浏览器收藏: GET可以收藏，POST不可以

浏览器缓存: GET可以缓存，POST不会

编码方式: GET通过url编码，POST支持多种编码

TCP数据包: GET产生一个数据包，POST产生2个数据包

使用方式(习惯上讲): GET主要拉取数据，POST主要提交保存数据
```

### url长度限制

实际上 HTTP 协议从未规定 GET/POST 的请求长度限制是多少。对 get 请求参数的限制是来源与浏览器或web 服务器，浏览器或 web 服务器限制了 url 的长度。为了明确这个概念，我们必须再次强调下面几点:

## CDN

CDN 是一个内容分发网络，通过对源网站资源的缓存，利用本身多台位于不同地域、不同运营商的服务器，向用户提供资就近访问的功能。

也就是说，用户的请求并不是直接发送给源网站，而是发送给 CDN 服务器，由 CND 服务器将请求定位到最近的含有该资源的服务器上去请求。

这样有利于提高网站的访问速度，同时通过这种方式也减轻了源服务器的访问压力。

## 什么是正向代理和反向代理

我们常说的代理也就是指正向代理，正向代理的过程，它隐藏了真实的请求客户端，服务端不知道真实的客户端是谁，客户端请求的服务都被代理服务器代替来请求。

反向代理隐藏了真实的服务端，当我们请求一个网站的时候，背后可能有成千上万台服务器为我们服务，但具体是哪一台，我们不知道，也不需要知道，我们只需要知道反向代理服务器是谁就好了，反向代理服务器会帮我们把请求转发到真实的服务器那里去。反向代理器一般用来实现负载平衡。

## 负载平衡的两种实现方式

一种是使用反向代理的方式，用户的请求都发送到反向代理服务上，然后由反向代理服务器来转发请求到真实的服务器上，以此来实现集群的负载平衡。

另一种是 DNS 的方式，DNS 可以用于在冗余的服务器上实现负载平衡。因为现在一般的大型网站使用多台服务器提供服务，因此一个域名可能会对应多个服务器地址。当用户向网站域名请求的时候，DNS 服务器返回这个域名所对应的服务器 IP 地址的集合，但在每个回答中，会循环这些 IP 地址的顺序，用户一般会选择排在前面的地址发送请求。以此将用户的请求均衡的分配到各个不同的服
务器上，这样来实现负载均衡。这种方式有一个缺点就是，由于 DNS 服务器中存在缓存，所以有可能一个服务器出现故障后，域名解析仍然返回的是那个 IP 地址，就会造成访问的问题。
