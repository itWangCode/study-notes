# js性能

## 注意作用域

访问全局变量总是要比访问局部变量慢，因为需要遍历作用域链.  
只要能减少花费在作用域链上的时间，就能增加脚本的整体性能。  

1. 避免全局查找

```javascript
functiontest(){
  //varimg=document.getElementByTagName('img');
  var doc=document;
  var img=doc.getElementByTagName('img');
}
```

2. 避免with语句

## 选择正确方法

### 避免不必要的属性查找

2
O(1),常数,不管有多少值，执行的时间都是恒定的。一般表示简单值和存储在变量中的值  
O(logn),对数,总的执行时间和值的数量相关，但是要完成算法并不一定要获取每个值。例如：二分查找  
O(n),线性,总执行时间和值的数量直接相关。例如：遍历某个数组中的所有元素  
O(n2),平方,总执行时间和值的数量有关，每个值至少要获取n次。例如：插入排序  

### 优化循环

* 减值迭代——大多数循环使用一个从0开始、增加到某个特定值的迭代器。在很多情况下，从最大值开始，在循环中不断减值的迭代器更加高效。
* 简化终止条件——由于每次循环过程都会计算终止条件，所以必须保证它尽可能快。也就是说避免属性查找或其他O(n)的操作。
* 简化循环体——循环体是执行最多的，所以要确保其被最大限度地优化。确保没有某些可以被很容易移出循环的密集计算。
* 使用后测试循环——最常用for循环和while循环都是前测试循环。而如do-while这种后测试循环，可以避免最初终止条件的计算，因此运行更快。

### 展开循环

### 避免双重解释

### 其他

* 原生方法较快——只要有可能，使用原生方法而不是自己用JavaScript重写一个。原生方法是用诸如C/C++之类的编译型语言写出来的，所以要比JavaScript的快很多很多。JavaScript中最容易被忘记的就是可以在Math对象中找到的复杂的数学运算；这些方法要比任何用JavaScript写的同样方法如正弦、余弦快的多。
* Switch语句较快——如果有一系列复杂的if-else语句，可以转换成单个switch语句则可以得到更快的代码。还可以通过将case语句按照最可能的到最不可能的顺序进行组织，来进一步优化switch语句。
* 位运算符较快——当进行数学运算的时候，位运算操作要比任何布尔运算或者算数运算快。选择性地用位运算替换算数运算可以极大提升复杂计算的性能。诸如取模，逻辑与和逻辑或都可以考虑用位运算来替换。

### 循环性能对比

我们遍历数组和对象都使用了for in这种方式，实际上for in在遍历时效率是非常低的，我们来对比下常见的三种循环for、while、for in的执行效率：

`while > for > for in`
