# 微前端

[2023微前端技术方案选型](https://juejin.cn/post/7236021829000691771)

[微前端到底是什么？](https://zhuanlan.zhihu.com/p/96464401)

[前端微服务在字节跳动的打磨与应用](https://juejin.cn/post/6844904046487142408)

[深入调研了微前端，还是iframe最香](https://juejin.cn/post/7244070072788287544)

<https://juejin.im/post/5d7f702ce51d4561f777e258>

<https://router.vuejs.org/zh/guide/advanced/lazy-loading.html#%E6%8A%8A%E7%BB%84%E4%BB%B6%E6%8C%89%E7%BB%84%E5%88%86%E5%9D%97>

<https://router.vuejs.org/zh/guide/essentials/nested-routes.html>

[微前端-从概念到开发](https://juejin.cn/book/6897057247579504653/section/6897053872334831620)

## 概念

简单来讲，微前端的理念类似于微服务：

关键字：拆解

理论上 ，微前端的概念是 ，完全独立的项目，他们之间不存在依赖关系。

将庞大的整体拆成可控的小块，并明确它们之间的依赖关系。关键优势在于：

代码库更小，更内聚、可维护性更高
松耦合、自治的团队可扩展性更好
渐进地升级、更新甚至重写部分前端功能成为了可能

## 框架

- qiankun  阿里

- microapp 京东

- 无界 腾讯

等等

## 多 Bundle 集成

微前端架构中一般会有个容器应用（container application）将各子应用集成起来，职责如下：

渲染公共的页面元素，比如 header、footer
解决横切关注点（cross-cutting concerns），如身份验证和导航
将各个微前端整合到一个页面上，并控制微前端的渲染区域和时机

```
集成方式分为 3 类：
服务端集成：如 SSR 拼装模板
构建时集成：如 Code Splitting
运行时集成：如通过 iframe、JS、Web Components 等方式
```

## 前端架构需要解决的问题

标准产品项目+定制化开发的场景 ，这两种拆解开。

拆开HTML打包，公用的资源包如果引用相同包，那公用内容变更，其实子应用，公用包都要重新打包。如果分开打包，虽然可以实现代码共用，但无法实现资源共用。如果完全独立的话，资源肯定是完全不共用的，因为发版是独立的，互不影响的。

- 拆开就要解决通信问题，弹窗全局等问题。

- 如何引入本地的库

- 如何整合托管在中心化服务中的库

- 如何开发通用服务，如异常跟踪，分析等

- 如何为团队设置CSS和URL前缀

## qiankun

<https://qiankun.umijs.org/zh/guide/>

是一个多个项目的集成框架。

quankun的消息并不是 应用A <-> 应用B，而是  应用A <-> 主应用 <-> 应用B

适合子应用之间通信耦合度低的，因为太高的耦合会在qiankun框架下会让通信变得复杂，难以维护，代码结构上不适合。

## webpack - Module Federation

概念：多个独立的构建可以组成一个应用程序,这些独立的构建之间不应该存在依赖关系，单独开发和部署它们。

这和webpack多页面应用程序有什么区别？

webpack如果一个项目无限加大，那它的打包内容大小极限是多少。会不会一个单页面应用无限增大，出现溢出编译失败。

用法：

1。 单页面/按照页面构建

单页面应用中，适用MF，可以将 每个路由（页面），单独构建，区别于常规的一起构建，可以分开构建。????好像没区别。

2。组件库作为容器

将 组件库单独打包部署，引用的有共用代码，？？？

3。动态远程容器

如果一个项目，两块或者多个子块 分开打包。

## webpack - 多页面

多页面，在协同上会有问题，要考虑：运行交互消息，样式一致，其他全局性的对接。所以如果是js和css都耦合性要求高的场景，多页面是不行的，需要单页面。

单页面就要考虑当项目程序无限增大时，编译是否出问题，比如时长，内存不够等。

## webpack - 单页面

单页面适用的场景是，项目耦合需求强，做远程动态加载

多页面适用的场景是，项目耦合性不强，代码有公共性，可以做成 单项目/多页面结构。

## 集成项目 - 框架结构

- 类型1:常规的一个大型前端多项目框架结构：

重点是公共资源的重复利用。

完全独立开发，只引用公共代码，但需要维护公共代码版本。

1。要考虑有多个独立项目的情况，动态增减，快捷拔插项目
2。独立编译，每个项目有各自的编译模块。
2。多个项目分别，独立部署
3。多个项目有公用代码，并维护。
4。是一个git仓库，或者分别的git仓库
5。接入cli 添加删除项目
6。项目内容，对公共引用的内容，范围：大屏组件代码级引用。有公共编译处理配置或者公共代码
7。编辑对公共代码，是同一个编译包，并且同一个资源引用，这样可以对公共代码，引用同一个静态资源。关于大屏的引用：独立项目最好能在基于大屏代码的某些基础上进行二次开发；配置+定制化 同时支持。可以理解为，可以代码加载主项目，并可以控制内容

实现思路：
公共编译，公共代码，子代码，子编译。
webpack5 vue3  
所有项目是一个git库，编译入口是主项目编译入口。

- 类型2:支持二次开发的大型结构：

基于某项目（大屏）进行二次 代码开发。

需要主项目研发，开放，支持二次开发的外部接口，如生命周期，事件注册回调，方法属性支持，渲染DOM支持等等。这样既可以实现二次开发的项目可以基于主项目（大屏）的配置开发，并同步配置；又可以在此的基础上，二次开发高自定义的功能；还可以独立发布，独立部署，项目分离。需要在主项目开发基于主 核心应用的外接第三方代码接入API，使项目独立且能二次代码开发。至于说二次开发项目的代码应该是需要独立发布部署的，也就是有独立的脚本。

这种结构也存在需要主项目与定制化代码需要版本同步的问题。其实所有引用代码的做法都存在同步代码的问题。

可以支持独立发布也可以支持融合主项目开发。

实现思路：
主要是主项目的封装，引入
