# 作用域

<http://cavszhouyou.top/JavaScript%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B9%8B%E4%BD%9C%E7%94%A8%E5%9F%9F%E9%93%BE.html>

## 块级作用域

  with，try/catch，let 没有给for if 等划分块级作用域  。

  ```javascript
  //函数作用域中 i 会再全局定义
  //而块级作用域下i不会全局定义
  for (var i= 0; i< 10; i++) {
    console. log( i );
  }
  ```

## 函数作用域  

含义是指，属于这个函数的全部变量都可以在整个函数的范围内使用及复用（事实上在嵌套的作用域中也可以使用）。例如：（var）

这种设计方案是非常有用的，能充分利用JavaScript变量可以根据需要改变值类型的“动态”特性。

在任 意 代码 片段 外部 添加 包装 函数， 可以 将 内部 的 变量 和 函数 定义“ 隐藏” 起来，  外部 作用域 无法 访问 包装 函数 内部 的 任何 内容。  函数 声明 和 函数 表达式 之间 最重要的 区别 是 它们 的 名称 标识符 将会 绑 定 在何处。  

  ```javascript
  (function foo(){ // <-- 添加 这 一行  //不行。 foo 变量 名 被 隐藏 在 自身 中， 不会 非必要 地 污染 外部 作用域。
    var a = 3;
    console. log( a ); // 3
  })(); // <-- 以及 这 一行
  ```

## 词法 作用域

是由 你在 写 代码 时 将 变量 和 块 作用域 写在 哪里 来 决定 的

  无论 函数 在哪里 被 调用， 也 无论 它 如何 被 调用， 它的 词法 作用域 都 只 由 函数 被 声明 时所处 的 位置 决定。
  编译时，而非运行时

  ```javascript
  function foo() {
    console. log( a ); // 2
  }
  function bar() {
    var a = 3; foo();
  }
  var a = 2;
  bar();
  ```

## 动态作用域

动态 作用域 并不 关心 函数 和 作用域 是 如何 声明 以及 在何处 声明 的， 只 关心 它们 从何 处 调用。 换句话说， 作用域 链 是 基于 调用 栈 的， 而 不是 代码 中的 作用域 嵌套。  

 需要 明确 的 是， 事实上 JavaScript 并不 具有 动态 作用域。 它 只有 词法 作用域， 简单 明了。 但是 this 机制 某种程度 上 很像 动态 作用域。  
 主要 区别： 词法 作用域 是在 写 代码 或者说 定义 时 确定 的， 而 动态 作用域 是在 运行时 确定 的。（ this 也是！） 词法 作用域 关注 函数 在何处 声明， 而 动态 作用域 关注 函数 从何 处 调用。

## 作用域链

当代码在一个环境中执行时，会创建变量对象的一个作用域链。作用域链的用途是保证对执行环境有权访问的所有变量和函数的有序访问。

通过作用域链，我们可以访问到外层环境的变量和函数。

变量对象里边包含了执行上下文中所有变量和函数的声明，它的作用就是保证代码执行时对变量和函数的正确访问。如果在该变量对象中没有找到对应变量或函数，则会根据执行作用域链向上继续查找，

作用域链本质上是一个指向变量对象的指针列表（在文中我们使用数组表示），它只引用但不实际包含变量对象。

作用域链的前端始终都是当前执行上下文的变量对象，如果这个执行上下文属于函数执行上下文，则用活动对象作为变量对象。

全局执行上下文的变量对象（也就是全局对象）始终是作用域链的最后一个对象
