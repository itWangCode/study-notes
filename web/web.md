



### CDN

Content Delivery Network,内容分发网络

通过把内容部署在全球各地，让用户从最近的服务器加载内容。大幅降低传播分组的时间。


### traceroute

traceroute测量延迟


### 带宽和延迟

延迟影响因素最大

### Ookla测宽带

http://speedtest.net


## TCP

IP：负责联网主机之间的路由选择和寻址
TCP:负责在不可靠的传输信道上提供可靠的抽象层。

HTTP可以用TCP传输协议或者其他，例如UDP协议


### 三次握手

1. 客户端选择一个随机序列号x，并发送一个SYN分组，其中可能还包括其他TCP标志和选项
2. SYN ACK : 服务器给X加1，并选择自己的一个随机序列号y，追加自己的标志和选项，然后返回响应
3. ACK：客户端给x和y加1并发送握手期间的最后一个ACK分组。

### 拥塞预防以及控制

#### 流量控制

rwnd：[接收窗口],发送端和接收端的接收窗口大小，包含能够保存数据的缓冲区空间大小的信息。

窗口缩放: TCP Window Scaling

4种预防流量暴增算法 ：慢启动，拥塞预防，快速重发，快速恢复

#### 慢启动

保守的窗口初始化链接，随后的每次往返都会成倍提高传输的数据量

cwnd：拥塞窗口大小，发送端对从客户端接收确认（ACK）之前可以发送数据量的限制。

指数增加传递cwnd

#### 拥塞预防

### 带宽延迟积

BDP:数据链路的容量与其端到端延迟的乘积。这个结果就是任意时刻处于在途未确认状态的最大数据量。

### 队首阻塞

按序交付和可靠交付的时候，TCP不是必要的选择。会导致额外的延迟，对性能造成负面影响。

无需按序交付数据或能够处理分组丢失的应用程序，以及对延迟或者抖动要求很高的应用程序，最好选择UDP等协议。

### TCP优化

- TCP三次握手增加了整整一次往返时间
- TCP慢启动讲被应用到每个新链接
- TCP流量及拥塞控制会影响所有链接的吞吐量
- TCP的吞吐量由当前拥塞窗口大小控制

#### 服务器配置调优

让服务器跟上时代是优化发送端和接收端的首要措施

优化项：

- 增大TCP的初始拥塞窗口

- 慢启动重启：在连接空闲时，禁用慢启动可以改善瞬时发送数据的长TCP连接的性能。

- 窗口缩放(RFC1332):启用窗口缩放可以增大最大接收窗口大小，可以让高延迟的连接增加吞吐量。

- TCP快速打开：

#### 应用程序行为调优

- 再快也快不过什么也不用发送，能少发就少发

- 我们不能让数据传输的更快，但可以让他们传输的距离更短

- 重用TCP连接是提升性能的关键，

#### 检查清单：

- 把服务器内核升级到最新版本
- 确保cwnd大小为10
- 禁用空闲后的慢启动
- 确保启动窗口缩放
- 减少传输冗余数据
- 压缩要传输的数据
- 把服务器放到离用户近的地方以减少往返时间
- 尽最大可能重用已经建立的TCP连接。

## UDP

## 传输层安全（TLS）

SSL(Secure Sockets Layer,安全套接字层)。

SSL不会影响上层协议（如HTTP，电子邮件，即时通讯），但能够保证上层协议的网络通信安全。

TSL1.0 也就是 SSL3.0 的升级版

1. 应用层（HTTP...）
2. 会话层 (TLS)
3. 传输层(TCP)
4. 网络层(IP)
5. 数据链路层
6. 物理层


### 加密，身份验证，完整性

加密：混淆数据的机制

身份验证：验证身份标识有效性的机制

完整性：检测消息是否被篡改或伪造的机制

### TLS握手

每个TLS连接在TCP握手基础上最多还需要两次额外的往返。

- **公钥与对称密钥加密：**

公钥加密系统只在建立TLS信道的会话中使用。  
在此期间服务器向客户端提供它的公钥，  
客户端生成密钥并使用服务器的公钥对其加密。然后讲加密的对称密钥返回给服务器  
服务器用自己的私钥解密出客户端发来的对称密钥

- HTTP通常是80端口，TLS是443端口

- ALPN(应用层协议协商)：作为TLS的扩展，让我们能在TLS握手的同时协商应用协议，从而省掉了HTTP的Upgrade机制所需的额外往返时间。

- 网络上可以建立TCP连接的任意两端都可以建立加密TLS信道，客户端只需知道另一段的IP地址，即可建立连接并进行TLS握手。

### TLS会话恢复

### 信任链与证书颁发机构

### 证书撤销

### TLS记录协议

与位于其下的IP或TCP层没有什么不同，TLS会话中交换的所有数据同样使用规格明确的协议进行分帧。TLS记录协议负责识别不同的消息类型（握手，警告或数据，通过“内容类型”字段），以及每条消息的安全和完整性验证。

### 针对TLS优化建议

#### 计算成本

SSL/TSL计算只占CPU负载的不到1%。  
以及不到2%的网络资源  
SSL/TSL计算已经不是问题了

- 要把SSL库升级到最新版本，在此基础上再构建Web服务器和代理服务器。最新的OpenSSL在性能方面有了明显的提升。


#### 今早完成(握手)

简言之：把服务器放到接近客户端的地方能够节约TCP和TLS握手的时间！

#### 会话缓存与无状态恢复

SSL2.0引入的会话表示符机制是TLS会话缓存的基础，目前已经得到大多数客户端和浏览器的广泛支持。

#### TLS记录大小

小记录会造成浪费，大记录会导致延迟。

#### TLS压缩

禁用TLS压缩，应该使用服务器的Gzip设置压缩所有文本资源，同时对图像，视频，音频等媒体采用最合适的压缩格式。

#### 证书链的长度

#### OCSP封套

#### HTTP严格传输安全（TSTS）

### TLS性能清单

- 要最大限制提升TCP性能
- 把TLS库升级到最新版本
- 启动并配置会话缓存和无状态恢复
- 监控会话缓存的使用情况并作出相应调整
- 在接近用户的地方完成TLS会话，尽量减少往返延迟
- 配置TLS大小，使其恰好能封装在一个TCP段内
- 确保证书链不会超过拥塞窗口的大小
- 从信任链中去掉不必要的证书，减少链条层次
- 禁用服务器的TLS压缩功能
- 启用服务器对SNI的支持
- 启用服务器的OCSP封套功能
- 追加HTTP严格传输安全首部


## 无线网络

### 类型

- 个人局域网(PAN)

个人活动范围；替代周边设备的线缆；蓝牙，ZigBee，NFC

- 局域网（LAN）

一栋楼或校园内；有线网络的无线扩展；IEEE 802.11（Wi-Fi）

- 城域网（MAN）

一座城市内；无线内联网；IEEE802.15（WiMax）

- 广域网（WAN）

世界范围内；无线网络；蜂窝（UMTS ， LTE等）

### 性能

- 带宽

无线落网是电磁辐射。发送端和接收端必须事先就通信使用的频率范围达成共识。  
影响性能的最主要因素就是频率范围的大小（带宽）。  
在其他条件等同的情况下，频率范围加倍，传输速度加倍。  
低频信号传输距离远，覆盖范围广（大蜂窝），但要求天线更大。高频信号能传输更多数据，但传输距离不远，覆盖范围小，需要较多的基础设施。


- 信号强度

收发两端之间的信号强度，信噪比（SNR，Signal Noise Ratio）；


- 调制

