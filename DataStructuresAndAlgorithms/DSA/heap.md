# 堆

<https://juejin.cn/post/6844904166318407688>

<https://juejin.cn/post/6844903508555071496>

<https://blog.csdn.net/qq_28063811/article/details/93034625>

堆是一种数据结构，一种叫做完全二叉树的数据结构。

堆 = 数据存储结构：队列 + 算法实现：完全二叉树

堆有大顶堆 小顶堆

## 大顶堆 小顶堆

任一结点的值是其子树所有结点的最大值或最小值。最大值时，称为“最大堆”，也称大顶堆；
最小值时，称为“最小堆”，也称小顶堆。

根据上述大小关系

```
对于大顶堆：arr[i] >= arr[2i + 1] && arr[i] >= arr[2i + 2]

对于小顶堆：arr[i] <= arr[2i + 1] && arr[i] <= arr[2i + 2]
```

## 插入

首先在堆的末尾插入该数值，然后不断向上调整，直到没有大小颠倒为止。

## 取最值

最值就在堆顶，即二叉树的第一个元素

## 删除最值

首先将堆的最后一个元素复杂到根节点，并删除最后一个元素，然后将根节点不断向下进行调整直到没有大小颠倒。

## 实现堆

操作实现，数据存储方式是 ： 把这种二叉树结构的数据映射到数组中，来操作。对应关系是：将序列里的值按照从上往下，从左到右依次填充到二叉树中。

假设当前节点的编号(数组中的编号)为i，则有：

它的父节点的编号为：i/2(整除)

它的左儿子节点的编号为：2*i

它的右儿子节点的编号为：2*i+1

## 堆排序

利用堆 实现数组排序

步骤：

1. 将无序数组操作为大顶堆下的数组

从最后一个非叶子节点 (len/2+1) 开始。

向前依次处理节点，比较节点与对应的左右子节点大小。如果，节点小于子节点，就和子节点换位置。

如果父节点被交换到子节点后，该节点还有子节点，继续处理子节点的交换

2. 排序序列：

将堆顶的元素值和尾部的元素交换。然后将剩余的元素重新构建大顶堆，其实就是调整根节点以及其调整后影响的子节点，因为其他节点之前已经满足大顶堆性质。

往返继续重复步骤2；

3. 得到结果。将有序的大顶堆转换为数组。最终得到有序序列
